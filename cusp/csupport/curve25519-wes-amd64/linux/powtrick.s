.text
.p2align 5
_scalBtoA:
scalBtoA:
mov  $0x7ffffffffffff,%rsi
mov  $121665,%r12
mov  %r13,%rax
imul %r12
shld $13,%rax,%rdx
and  %rsi,%rax
mov  %rax,%r9
mov  %rdx,%rdi
mov  %r14,%rax
imul %r12
shld $13,%rax,%rdx
and  %rsi,%rax
lea  (%rax,%rdi),%rdi
mov  %rdx,%r8
mov  %r15,%rax
imul %r12
shld $13,%rax,%rdx
and  %rsi,%rax
lea  (%rax,%r8),%r10
mov  %rdx,%r8
mov  %rbx,%rax
imul %r12
shld $13,%rax,%rdx
and  %rsi,%rax
lea  (%rax,%r8),%r11
mov  %rdx,%r8
mov  %rbp,%rax
imul %r12
shld $13,%rax,%rdx
and  %rsi,%rax
lea  (%rax,%r8),%r12
imul  $19,%rdx
add  %rdx,%r9
ret
.text
.p2align 5
_sqrAtoB:
sqrAtoB:
mov  %r11,%r15
mov  %r12,%rbx
imul  $19,%r15
imul  $19,%rbx
lea  (%rdi,%rdi),%rax
imul %rbx
mov  %rax,%rsi
mov  %rdx,%r8
lea  (%r10,%r10),%rax
imul %r15
add  %rax,%rsi
adc %rdx,%r8
mov  %r9,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r13
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%r10,%r10),%rax
imul %rbx
add  %rax,%rsi
adc %rdx,%r8
mov  %r11,%rax
imul %r15
add  %rax,%rsi
adc %rdx,%r8
lea  (%r9,%r9),%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r14
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%r11,%r11),%rax
imul %rbx
add  %rax,%rsi
adc %rdx,%r8
lea  (%r9,%r9),%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %rdi,%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r15
shrd $51,%r8,%rsi
sar  $51,%r8
mov  %r12,%rax
imul %rbx
add  %rax,%rsi
adc %rdx,%r8
lea  (%r9,%r9),%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
lea  (%rdi,%rdi),%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%rbx
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%r9,%r9),%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
lea  (%rdi,%rdi),%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %r10,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%rbp
shrd $51,%r8,%rsi
sar  $51,%r8
imul  $19,%r8
mov  $19,%rax
mul  %rsi
add  %r8,%rdx
mov  $0x7ffffffffffff,%rsi
and  %rsi,%r13
and  %rsi,%r14
and  %rsi,%r15
and  %rsi,%rbx
and  %rsi,%rbp
and  %rax,%rsi
shrd $51,%rdx,%rax
add  %rsi,%r13
add  %rax,%r14
ret
.text
.p2align 5
_sqrBtoA:
sqrBtoA:
mov  %rbx,%r10
mov  %rbp,%r11
imul  $19,%r10
imul  $19,%r11
lea  (%r14,%r14),%rax
imul %r11
mov  %rax,%rsi
mov  %rdx,%r8
lea  (%r15,%r15),%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %r13,%rax
imul %r13
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r9
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%r15,%r15),%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %rbx,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
lea  (%r13,%r13),%rax
imul %r14
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%rdi
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%rbx,%rbx),%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
lea  (%r13,%r13),%rax
imul %r15
add  %rax,%rsi
adc %rdx,%r8
mov  %r14,%rax
imul %r14
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r10
shrd $51,%r8,%rsi
sar  $51,%r8
mov  %rbp,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
lea  (%r13,%r13),%rax
imul %rbx
add  %rax,%rsi
adc %rdx,%r8
lea  (%r14,%r14),%rax
imul %r15
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r11
shrd $51,%r8,%rsi
sar  $51,%r8
lea  (%r13,%r13),%rax
imul %rbp
add  %rax,%rsi
adc %rdx,%r8
lea  (%r14,%r14),%rax
imul %rbx
add  %rax,%rsi
adc %rdx,%r8
mov  %r15,%rax
imul %r15
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r12
shrd $51,%r8,%rsi
sar  $51,%r8
imul  $19,%r8
mov  $19,%rax
mul  %rsi
add  %r8,%rdx
mov  $0x7ffffffffffff,%rsi
and  %rsi,%r9
and  %rsi,%rdi
and  %rsi,%r10
and  %rsi,%r11
and  %rsi,%r12
and  %rax,%rsi
shrd $51,%rdx,%rax
add  %rsi,%r9
add  %rax,%rdi
ret
.text
.p2align 5
_mulACtoB:
mulACtoB:
movd   %xmm1,%r13
movd   %xmm2,%r14
movd   %xmm3,%r15
movd   %xmm4,%rbx
imul  $19,%r13
imul  $19,%r14
imul  $19,%r15
imul  $19,%rbx
mov  %rbx,%rax
imul %rdi
mov  %rax,%rsi
mov  %rdx,%r8
mov  %r15,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %r14,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %r13,%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm0,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r13
shrd $51,%r8,%rsi
sar  $51,%r8
mov  %rbx,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %r15,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %r14,%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm1,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm0,%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r14
shrd $51,%r8,%rsi
sar  $51,%r8
mov  %rbx,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %r15,%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm2,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm1,%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm0,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%r15
shrd $51,%r8,%rsi
sar  $51,%r8
mov  %rbx,%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm3,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm2,%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm1,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm0,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%rbx
shrd $51,%r8,%rsi
sar  $51,%r8
movd   %xmm4,%rax
imul %r9
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm3,%rax
imul %rdi
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm2,%rax
imul %r10
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm1,%rax
imul %r11
add  %rax,%rsi
adc %rdx,%r8
movd   %xmm0,%rax
imul %r12
add  %rax,%rsi
adc %rdx,%r8
mov  %rsi,%rbp
shrd $51,%r8,%rsi
sar  $51,%r8
imul  $19,%r8
mov  $19,%rax
mul  %rsi
add  %r8,%rdx
mov  $0x7ffffffffffff,%rsi
and  %rsi,%r13
and  %rsi,%r14
and  %rsi,%r15
and  %rsi,%rbx
and  %rsi,%rbp
and  %rax,%rsi
shrd $51,%rdx,%rax
add  %rsi,%r13
add  %rax,%r14
ret
.text
.p2align 5
_powtrick:
powtrick:
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
movd   %r9,%xmm5
movd   %rdi,%xmm6
movd   %r10,%xmm7
movd   %r11,%xmm8
movd   %r12,%xmm9
call sqrAtoB
call sqrBtoA
call mulACtoB
movd   %xmm5,%r9
movd   %xmm6,%rdi
movd   %xmm7,%r10
movd   %xmm8,%r11
movd   %xmm9,%r12
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call mulACtoB
movd   %r13,%xmm10
movd   %r14,%xmm11
movd   %r15,%xmm12
movd   %rbx,%xmm13
movd   %rbp,%xmm14
call sqrBtoA
call mulACtoB
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call mulACtoB
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
call mulACtoB
movdqa %xmm0,%xmm5
movdqa %xmm1,%xmm6
movdqa %xmm2,%xmm7
movdqa %xmm3,%xmm8
movdqa %xmm4,%xmm9
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
call mulACtoB
movdqa %xmm5,%xmm0
movdqa %xmm6,%xmm1
movdqa %xmm7,%xmm2
movdqa %xmm8,%xmm3
movdqa %xmm9,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
call mulACtoB
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
call mulACtoB
movdqa %xmm0,%xmm5
movdqa %xmm1,%xmm6
movdqa %xmm2,%xmm7
movdqa %xmm3,%xmm8
movdqa %xmm4,%xmm9
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
call mulACtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
mov  %r13,%r9
mov  %r14,%rdi
mov  %r15,%r10
mov  %rbx,%r11
mov  %rbp,%r12
movdqa %xmm5,%xmm0
movdqa %xmm6,%xmm1
movdqa %xmm7,%xmm2
movdqa %xmm8,%xmm3
movdqa %xmm9,%xmm4
call mulACtoB
ret
