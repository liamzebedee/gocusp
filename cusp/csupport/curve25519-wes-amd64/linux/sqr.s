.text
.p2align 5
.globl _field25519_wes_sqr
.globl field25519_wes_sqr
_field25519_wes_sqr:
field25519_wes_sqr:
mov %rsp,%r11
and $31,%r11
add $64,%r11
sub %r11,%rsp
movq %r11,0(%rsp)
movq %r12,8(%rsp)
movq %r13,16(%rsp)
movq %r14,24(%rsp)
movq %r15,32(%rsp)
movd   %rdi,%xmm0
movq   0(%rsi),%rdi
movq   8(%rsi),%rcx
movq   16(%rsi),%r8
movq   24(%rsi),%r9
movq   32(%rsi),%rsi
mov  %rsi,%r10
mov  %r9,%r11
imul  $19,%r10
imul  $19,%r11
lea  (%rcx,%rcx),%rax
imul %r10
mov  %rax,%r12
mov  %rdx,%r13
lea  (%r8,%r8),%rax
imul %r11
add  %rax,%r12
adc %rdx,%r13
mov  %rdi,%rax
imul %rdi
add  %rax,%r12
adc %rdx,%r13
mov  %r12,%r14
shrd $51,%r13,%r12
sar  $51,%r13
lea  (%r8,%r8),%rax
imul %r10
add  %rax,%r12
adc %rdx,%r13
mov  %r9,%rax
imul %r11
add  %rax,%r12
adc %rdx,%r13
lea  (%rdi,%rdi),%rax
imul %rcx
add  %rax,%r12
adc %rdx,%r13
mov  %r12,%r11
shrd $51,%r13,%r12
sar  $51,%r13
lea  (%r9,%r9),%rax
imul %r10
add  %rax,%r12
adc %rdx,%r13
lea  (%rdi,%rdi),%rax
imul %r8
add  %rax,%r12
adc %rdx,%r13
mov  %rcx,%rax
imul %rcx
add  %rax,%r12
adc %rdx,%r13
mov  %r12,%r15
shrd $51,%r13,%r12
sar  $51,%r13
mov  %rsi,%rax
imul %r10
add  %rax,%r12
adc %rdx,%r13
lea  (%rdi,%rdi),%rax
imul %r9
add  %rax,%r12
adc %rdx,%r13
lea  (%rcx,%rcx),%rax
imul %r8
add  %rax,%r12
adc %rdx,%r13
mov  %r12,%r10
shrd $51,%r13,%r12
sar  $51,%r13
lea  (%rdi,%rdi),%rax
imul %rsi
add  %rax,%r12
adc %rdx,%r13
lea  (%rcx,%rcx),%rax
imul %r9
add  %rax,%r12
adc %rdx,%r13
mov  %r8,%rax
imul %r8
add  %rax,%r12
adc %rdx,%r13
mov  %r12,%rdi
shrd $51,%r13,%r12
sar  $51,%r13
mov  $0x7ffffffffffff,%rsi
movd   %xmm0,%rcx
and  %rsi,%r14
and  %rsi,%r11
and  %rsi,%r15
and  %rsi,%r10
and  %rsi,%rdi
imul  $19,%r13
mov  $19,%rax
mul  %r12
add  %r13,%rdx
and  %rax,%rsi
shrd $51,%rdx,%rax
add  %rsi,%r14
add  %rax,%r11
movq   %r14,0(%rcx)
movq   %r11,8(%rcx)
movq   %r15,16(%rcx)
movq   %r10,24(%rcx)
movq   %rdi,32(%rcx)
movq 0(%rsp),%r11
movq 8(%rsp),%r12
movq 16(%rsp),%r13
movq 24(%rsp),%r14
movq 32(%rsp),%r15
add %r11,%rsp
ret
