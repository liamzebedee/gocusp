.text
.p2align 5
.globl _field25519_wes_mul
.globl field25519_wes_mul
_field25519_wes_mul:
field25519_wes_mul:
mov %rsp,%r11
and $31,%r11
add $64,%r11
sub %r11,%rsp
movq %r11,0(%rsp)
movq %r12,8(%rsp)
movq %r13,16(%rsp)
movq %r14,24(%rsp)
movq %r15,32(%rsp)
movd   %rdi,%xmm0
movq   0(%rsi),%rdi
movq   8(%rsi),%rcx
movq   16(%rsi),%r8
movq   24(%rsi),%r9
movq   32(%rsi),%rsi
movq   0(%rdx),%r10
movq   8(%rdx),%r11
movq   16(%rdx),%r12
movq   24(%rdx),%r13
movq   32(%rdx),%r14
movd   %rdi,%xmm1
movd   %rcx,%xmm2
movd   %r8,%xmm3
movd   %r9,%xmm4
movd   %rsi,%xmm5
imul  $19,%rcx
imul  $19,%r8
imul  $19,%r9
imul  $19,%rsi
mov  %rsi,%rax
imul %r11
mov  %rax,%rdi
mov  %rdx,%r15
mov  %r9,%rax
imul %r12
add  %rax,%rdi
adc %rdx,%r15
mov  %r8,%rax
imul %r13
add  %rax,%rdi
adc %rdx,%r15
mov  %rcx,%rax
imul %r14
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm1,%rax
imul %r10
add  %rax,%rdi
adc %rdx,%r15
mov  %rdi,%rcx
shrd $51,%r15,%rdi
sar  $51,%r15
mov  %rsi,%rax
imul %r12
add  %rax,%rdi
adc %rdx,%r15
mov  %r9,%rax
imul %r13
add  %rax,%rdi
adc %rdx,%r15
mov  %r8,%rax
imul %r14
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm2,%rax
imul %r10
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm1,%rax
imul %r11
add  %rax,%rdi
adc %rdx,%r15
mov  %rdi,%r8
shrd $51,%r15,%rdi
sar  $51,%r15
mov  %rsi,%rax
imul %r13
add  %rax,%rdi
adc %rdx,%r15
mov  %r9,%rax
imul %r14
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm3,%rax
imul %r10
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm2,%rax
imul %r11
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm1,%rax
imul %r12
add  %rax,%rdi
adc %rdx,%r15
mov  %rdi,%r9
shrd $51,%r15,%rdi
sar  $51,%r15
mov  %rsi,%rax
imul %r14
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm4,%rax
imul %r10
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm3,%rax
imul %r11
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm2,%rax
imul %r12
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm1,%rax
imul %r13
add  %rax,%rdi
adc %rdx,%r15
mov  %rdi,%rsi
shrd $51,%r15,%rdi
sar  $51,%r15
movd   %xmm5,%rax
imul %r10
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm4,%rax
imul %r11
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm3,%rax
imul %r12
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm2,%rax
imul %r13
add  %rax,%rdi
adc %rdx,%r15
movd   %xmm1,%rax
imul %r14
add  %rax,%rdi
adc %rdx,%r15
mov  %rdi,%r10
shrd $51,%r15,%rdi
sar  $51,%r15
mov  $0x7ffffffffffff,%r11
movd   %xmm0,%r12
and  %r11,%rcx
and  %r11,%r8
and  %r11,%r9
and  %r11,%rsi
and  %r11,%r10
imul  $19,%r15
mov  $19,%rax
mul  %rdi
add  %r15,%rdx
and  %rax,%r11
shrd $51,%rdx,%rax
add  %r11,%rcx
add  %rax,%r8
movq   %rcx,0(%r12)
movq   %r8,8(%r12)
movq   %r9,16(%r12)
movq   %rsi,24(%r12)
movq   %r10,32(%r12)
movq 0(%rsp),%r11
movq 8(%rsp),%r12
movq 16(%rsp),%r13
movq 24(%rsp),%r14
movq 32(%rsp),%r15
add %r11,%rsp
ret
