.text
.p2align 5
.globl _field25519_wes_powq
.globl field25519_wes_powq
_field25519_wes_powq:
field25519_wes_powq:
mov %rsp,%r11
and $31,%r11
add $256,%r11
sub %r11,%rsp
movdqa %xmm6,0(%rsp)
movdqa %xmm7,16(%rsp)
movdqa %xmm8,32(%rsp)
movdqa %xmm9,48(%rsp)
movdqa %xmm10,64(%rsp)
movdqa %xmm11,80(%rsp)
movdqa %xmm12,96(%rsp)
movdqa %xmm13,112(%rsp)
movdqa %xmm14,128(%rsp)
movdqa %xmm15,144(%rsp)
movq %r11,160(%rsp)
movq %r12,168(%rsp)
movq %r13,176(%rsp)
movq %r14,184(%rsp)
movq %r15,192(%rsp)
movq %rbx,200(%rsp)
movq %rbp,208(%rsp)
movq %rdi,216(%rsp)
movq %rsi,224(%rsp)
movq   0(%rsi),%r13
movq   8(%rsi),%r14
movq   16(%rsi),%r15
movq   24(%rsi),%rbx
movq   32(%rsi),%rbp
call powtrick
call sqrBtoA
call sqrAtoB
movq 224(%rsp),%rsi
movq   0(%rsi),%r9
movq   8(%rsi),%rdi
movq   16(%rsi),%r10
movq   24(%rsi),%r11
movq   32(%rsi),%r12
movd   %r13,%xmm0
movd   %r14,%xmm1
movd   %r15,%xmm2
movd   %rbx,%xmm3
movd   %rbp,%xmm4
call mulACtoB
movq 216(%rsp),%rdi
movq   %r13,0(%rdi)
movq   %r14,8(%rdi)
movq   %r15,16(%rdi)
movq   %rbx,24(%rdi)
movq   %rbp,32(%rdi)
movdqa 0(%rsp),%xmm6
movdqa 16(%rsp),%xmm7
movdqa 32(%rsp),%xmm8
movdqa 48(%rsp),%xmm9
movdqa 64(%rsp),%xmm10
movdqa 80(%rsp),%xmm11
movdqa 96(%rsp),%xmm12
movdqa 112(%rsp),%xmm13
movdqa 128(%rsp),%xmm14
movdqa 144(%rsp),%xmm15
movq 160(%rsp),%r11
movq 168(%rsp),%r12
movq 176(%rsp),%r13
movq 184(%rsp),%r14
movq 192(%rsp),%r15
movq 200(%rsp),%rbx
movq 208(%rsp),%rbp
add %r11,%rsp
ret
