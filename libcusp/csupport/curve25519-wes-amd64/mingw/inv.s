.text
.p2align 5
.globl _field25519_wes_inv
.globl field25519_wes_inv
_field25519_wes_inv:
field25519_wes_inv:
mov %rsp,%r11
and $31,%r11
add $256,%r11
sub %r11,%rsp
movdqa %xmm6,0(%rsp)
movdqa %xmm7,16(%rsp)
movdqa %xmm8,32(%rsp)
movdqa %xmm9,48(%rsp)
movdqa %xmm10,64(%rsp)
movdqa %xmm11,80(%rsp)
movdqa %xmm12,96(%rsp)
movdqa %xmm13,112(%rsp)
movdqa %xmm14,128(%rsp)
movdqa %xmm15,144(%rsp)
movq %r11,160(%rsp)
movq %r12,168(%rsp)
movq %r13,176(%rsp)
movq %r14,184(%rsp)
movq %r15,192(%rsp)
movq %rdi,200(%rsp)
movq %rsi,208(%rsp)
movq %rbp,216(%rsp)
movq %rbx,224(%rsp)
movq %rcx,232(%rsp)
movq   0(%rdx),%r15
movq   8(%rdx),%rdi
movq   16(%rdx),%rsi
movq   24(%rdx),%rbp
movq   32(%rdx),%rbx
call powtrick
call sqrBtoA
call sqrAtoB
call sqrBtoA
call sqrAtoB
call sqrBtoA
movdqa %xmm10,%xmm0
movdqa %xmm11,%xmm1
movdqa %xmm12,%xmm2
movdqa %xmm13,%xmm3
movdqa %xmm14,%xmm4
call mulACtoB
movq 232(%rsp),%rcx
movq   %r15,0(%rcx)
movq   %rdi,8(%rcx)
movq   %rsi,16(%rcx)
movq   %rbp,24(%rcx)
movq   %rbx,32(%rcx)
movdqa 0(%rsp),%xmm6
movdqa 16(%rsp),%xmm7
movdqa 32(%rsp),%xmm8
movdqa 48(%rsp),%xmm9
movdqa 64(%rsp),%xmm10
movdqa 80(%rsp),%xmm11
movdqa 96(%rsp),%xmm12
movdqa 112(%rsp),%xmm13
movdqa 128(%rsp),%xmm14
movdqa 144(%rsp),%xmm15
movq 160(%rsp),%r11
movq 168(%rsp),%r12
movq 176(%rsp),%r13
movq 184(%rsp),%r14
movq 192(%rsp),%r15
movq 200(%rsp),%rdi
movq 208(%rsp),%rsi
movq 216(%rsp),%rbp
movq 224(%rsp),%rbx
add %r11,%rsp
ret
