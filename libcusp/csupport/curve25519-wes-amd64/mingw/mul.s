.text
.p2align 5
.globl _field25519_wes_mul
.globl field25519_wes_mul
_field25519_wes_mul:
field25519_wes_mul:
mov %rsp,%r11
and $31,%r11
add $64,%r11
sub %r11,%rsp
movq %r11,0(%rsp)
movq %r12,8(%rsp)
movq %r13,16(%rsp)
movq %r14,24(%rsp)
movq %r15,32(%rsp)
movq %rdi,40(%rsp)
movq %rsi,48(%rsp)
movd   %rcx,%xmm0
movq   0(%rdx),%rcx
movq   8(%rdx),%r9
movq   16(%rdx),%r10
movq   24(%rdx),%r11
movq   32(%rdx),%r12
movq   0(%r8),%r13
movq   8(%r8),%r14
movq   16(%r8),%r15
movq   24(%r8),%rdi
movq   32(%r8),%r8
movd   %rcx,%xmm1
movd   %r9,%xmm2
movd   %r10,%xmm3
movd   %r11,%xmm4
movd   %r12,%xmm5
imul  $19,%r9
imul  $19,%r10
imul  $19,%r11
imul  $19,%r12
mov  %r12,%rax
imul %r14
mov  %rax,%rcx
mov  %rdx,%rsi
mov  %r11,%rax
imul %r15
add  %rax,%rcx
adc %rdx,%rsi
mov  %r10,%rax
imul %rdi
add  %rax,%rcx
adc %rdx,%rsi
mov  %r9,%rax
imul %r8
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm1,%rax
imul %r13
add  %rax,%rcx
adc %rdx,%rsi
mov  %rcx,%r9
shrd $51,%rsi,%rcx
sar  $51,%rsi
mov  %r12,%rax
imul %r15
add  %rax,%rcx
adc %rdx,%rsi
mov  %r11,%rax
imul %rdi
add  %rax,%rcx
adc %rdx,%rsi
mov  %r10,%rax
imul %r8
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm2,%rax
imul %r13
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm1,%rax
imul %r14
add  %rax,%rcx
adc %rdx,%rsi
mov  %rcx,%r10
shrd $51,%rsi,%rcx
sar  $51,%rsi
mov  %r12,%rax
imul %rdi
add  %rax,%rcx
adc %rdx,%rsi
mov  %r11,%rax
imul %r8
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm3,%rax
imul %r13
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm2,%rax
imul %r14
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm1,%rax
imul %r15
add  %rax,%rcx
adc %rdx,%rsi
mov  %rcx,%r11
shrd $51,%rsi,%rcx
sar  $51,%rsi
mov  %r12,%rax
imul %r8
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm4,%rax
imul %r13
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm3,%rax
imul %r14
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm2,%rax
imul %r15
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm1,%rax
imul %rdi
add  %rax,%rcx
adc %rdx,%rsi
mov  %rcx,%r12
shrd $51,%rsi,%rcx
sar  $51,%rsi
movd   %xmm5,%rax
imul %r13
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm4,%rax
imul %r14
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm3,%rax
imul %r15
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm2,%rax
imul %rdi
add  %rax,%rcx
adc %rdx,%rsi
movd   %xmm1,%rax
imul %r8
add  %rax,%rcx
adc %rdx,%rsi
mov  %rcx,%r8
shrd $51,%rsi,%rcx
sar  $51,%rsi
mov  $0x7ffffffffffff,%r13
movd   %xmm0,%r14
and  %r13,%r9
and  %r13,%r10
and  %r13,%r11
and  %r13,%r12
and  %r13,%r8
imul  $19,%rsi
mov  $19,%rax
mul  %rcx
add  %rsi,%rdx
and  %rax,%r13
shrd $51,%rdx,%rax
add  %r13,%r9
add  %rax,%r10
movq   %r9,0(%r14)
movq   %r10,8(%r14)
movq   %r11,16(%r14)
movq   %r12,24(%r14)
movq   %r8,32(%r14)
movq 0(%rsp),%r11
movq 8(%rsp),%r12
movq 16(%rsp),%r13
movq 24(%rsp),%r14
movq 32(%rsp),%r15
movq 40(%rsp),%rdi
movq 48(%rsp),%rsi
add %r11,%rsp
ret
