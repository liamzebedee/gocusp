.text
.p2align 5
.globl _field25519_wes_contract
.globl field25519_wes_contract
_field25519_wes_contract:
field25519_wes_contract:
movd   %rcx,%xmm0
movq   0(%rdx),%rcx
movq   8(%rdx),%r8
movq   16(%rdx),%r9
movq   24(%rdx),%rax
movq   32(%rdx),%rdx
mov  %rcx,%r10
sar  $63,%r10
mov  %r8,%r11
shl  $51,%r11
sar  $13,%r8
add  %r11,%rcx
adc %r10,%r8
mov  %r8,%r10
sar  $63,%r10
mov  %r9,%r11
shl  $38,%r11
sar  $26,%r9
add  %r11,%r8
adc %r10,%r9
mov  %r9,%r10
sar  $63,%r10
mov  %rax,%r11
shl  $25,%r11
sar  $39,%rax
add  %r11,%r9
adc %r10,%rax
mov  %rax,%r10
sar  $63,%r10
mov  %rdx,%r11
shl  $12,%r11
sar  $52,%rdx
add  %r11,%rax
adc %r10,%rdx
shld $1,%rax,%rdx
shl  $1,%rax
shr  $1,%rax
mov  %rdx,%r10
sar  $63,%r10
lea  1(%rdx,%r10),%rdx
imul  $19,%rdx
add  %rdx,%rcx
adc %r10,%r8
adc %r10,%r9
adc %r10,%rax
shl  $63,%r10
add  %r10,%rax
mov  $19,%rdx
mov  %rax,%r10
sar  $63,%r10
not  %r10
and  %r10,%rdx
sub  %rdx,%rcx
sbb $0,%r8
sbb $0,%r9
sbb $0,%rax
shl  $1,%rax
shr  $1,%rax
movd   %xmm0,%rdx
movq   %rcx,0(%rdx)
movq   %r8,8(%rdx)
movq   %r9,16(%rdx)
movq   %rax,24(%rdx)
ret
